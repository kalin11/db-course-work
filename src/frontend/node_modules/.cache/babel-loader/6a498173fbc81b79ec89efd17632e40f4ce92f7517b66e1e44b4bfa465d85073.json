{"ast":null,"code":"import{useNavigate}from\"react-router-dom\";import{useEffect,useState}from\"react\";import axios from\"../../config/axios\";import Button from\"../buttons/Button\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const ReplyCommentItem=_ref=>{let{username,createdDate,comment,commentId,lastUpdatedAt,parentCommentId}=_ref;const[content,setContent]=useState(comment);const navigate=useNavigate();const[isAdmin,setIsAdmin]=useState(false);const[isModerator,setIsModerator]=useState(false);const[isAnonymous,setIsAnonymous]=useState(true);const[editMode,setEditMode]=useState(false);const[nickName,setNickName]=useState('');const[replies,setReplies]=useState([]);const[parentId,setParentId]=useState(43);const goToProfile=()=>{if(username!==''){navigate('/users/'+username);}};const turnOnEditMode=()=>{setEditMode(!editMode);};const deleteComment=()=>{return axios.delete('/comments/'+commentId,{headers:{\"Access-Control-Allow-Origin\":\"*\"},withCredentials:true}).then(response=>{return response.data;}).catch(error=>{return error.response.data;});};const updateComment=()=>{setEditMode(false);return axios.put('/comments',{id:commentId,content:content},{headers:{\"Access-Control-Allow-Origin\":\"*\"},withCredentials:true}).then(response=>{return response.data;}).catch(error=>{if(error.response.status===403){console.log(\"Недостаточно прав\");}return error.response;});};// useEffect(() => {\n//     if (isNaN(parseInt(parentCommentId))) {\n//         setParentId(null);\n//     }\n//     else {\n//         setParentId(parentId(parentCommentId));\n//     }\n// }, []);\nuseEffect(()=>{if(JSON.parse(sessionStorage.getItem('user'))===null){setIsAdmin(false);setIsModerator(false);setIsAnonymous(true);}else{if(JSON.parse(sessionStorage.getItem('user')).role==='Администратор'){setIsAdmin(true);setIsAnonymous(false);}else if(JSON.parse(sessionStorage.getItem('user')).role==='Модератор'){setIsModerator(true);setIsAnonymous(false);}setNickName(JSON.parse(sessionStorage.getItem('user')).nickname);}},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded ml-auto mt-3 mb-3 w-[90%]\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex cursor-pointer\",onClick:goToProfile,children:[username,\", \\u0432 \\u043E\\u0442\\u0432\\u0435\\u0442 \\u043D\\u0430 \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439 \\u0432\\u044B\\u0448\\u0435\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex mt-3 mb-3\",children:[\"\\u0414\\u0430\\u0442\\u0430 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u044F - \",createdDate]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex ml-auto\",children:[(isAdmin||isModerator)&&!isAnonymous&&/*#__PURE__*/ // isModerator &&\n_jsx(\"div\",{className:\"flex mt-3 mb-3 ml-auto mr-2 cursor-pointer\",onClick:deleteComment,children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"}),nickName===username&&/*#__PURE__*/_jsx(\"div\",{className:\"flex mt-3 mb-3 ml-auto mr-2 cursor-pointer\",onClick:turnOnEditMode,children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex mt-3 mb-3\",children:[\"\\u0414\\u0430\\u0442\\u0430 \\u0438\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u044F - \",lastUpdatedAt]}),!editMode&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[comment,/*#__PURE__*/_jsx(\"div\",{className:\"flex ml-1\",children:createdDate!==lastUpdatedAt&&'(ред.)'})]}),editMode&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"flex rounded bg-gray-200\",defaultValue:comment,onChange:e=>setContent(e.target.value)}),/*#__PURE__*/_jsx(Button,{text:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\",handleButton:updateComment})]}),parentId!==null&&/*#__PURE__*/_jsx(\"div\",{})]},commentId);};export default ReplyCommentItem;","map":{"version":3,"names":["useNavigate","useEffect","useState","axios","Button","jsxs","_jsxs","jsx","_jsx","ReplyCommentItem","_ref","username","createdDate","comment","commentId","lastUpdatedAt","parentCommentId","content","setContent","navigate","isAdmin","setIsAdmin","isModerator","setIsModerator","isAnonymous","setIsAnonymous","editMode","setEditMode","nickName","setNickName","replies","setReplies","parentId","setParentId","goToProfile","turnOnEditMode","deleteComment","delete","headers","withCredentials","then","response","data","catch","error","updateComment","put","id","status","console","log","JSON","parse","sessionStorage","getItem","role","nickname","className","children","onClick","defaultValue","onChange","e","target","value","text","handleButton"],"sources":["/home/kalin/IdeaProjects/tinkoff-project-develop/src/frontend/src/components/items/ReplyCommentItem.js"],"sourcesContent":["import {useNavigate} from \"react-router-dom\";\nimport {useEffect, useState} from \"react\";\nimport axios from \"../../config/axios\";\nimport Button from \"../buttons/Button\";\n\nconst ReplyCommentItem = ({username, createdDate, comment, commentId, lastUpdatedAt, parentCommentId}) => {\n\n    const [content, setContent] = useState(comment);\n\n    const navigate = useNavigate();\n\n    const [isAdmin, setIsAdmin] = useState(false);\n    const [isModerator, setIsModerator] = useState(false);\n    const [isAnonymous, setIsAnonymous] = useState(true);\n\n    const [editMode, setEditMode] = useState(false);\n    const [nickName, setNickName] = useState('');\n\n    const [replies, setReplies] = useState([]);\n    const [parentId, setParentId] = useState(43);\n\n    const goToProfile = () => {\n        if (username !== '') {\n            navigate('/users/' + username);\n        }\n    }\n\n    const turnOnEditMode = () => {\n        setEditMode(!editMode);\n    }\n\n    const deleteComment = () => {\n        return axios\n            .delete('/comments/' + commentId, {\n                headers: {\n                    \"Access-Control-Allow-Origin\": \"*\"\n                },\n                withCredentials: true\n            })\n            .then((response) => {\n                return response.data;\n            })\n            .catch((error) => {\n                return error.response.data;\n            })\n    }\n\n    const updateComment = () => {\n        setEditMode(false);\n        return axios\n            .put('/comments', {id: commentId, content: content},\n                {\n                    headers: {\n                        \"Access-Control-Allow-Origin\": \"*\"\n                    },\n                    withCredentials: true\n                })\n            .then((response) => {\n                return response.data;\n            })\n            .catch((error) => {\n                if (error.response.status === 403) {\n                    console.log(\"Недостаточно прав\")\n                }\n                return error.response;\n            })\n    }\n\n    // useEffect(() => {\n    //     if (isNaN(parseInt(parentCommentId))) {\n    //         setParentId(null);\n    //     }\n    //     else {\n    //         setParentId(parentId(parentCommentId));\n    //     }\n    // }, []);\n\n    useEffect(() => {\n        if (JSON.parse(sessionStorage.getItem('user')) === null) {\n            setIsAdmin(false);\n            setIsModerator(false);\n            setIsAnonymous(true);\n        } else {\n            if (JSON.parse(sessionStorage.getItem('user')).role === 'Администратор') {\n                setIsAdmin(true);\n                setIsAnonymous(false);\n            } else if (JSON.parse(sessionStorage.getItem('user')).role === 'Модератор') {\n                setIsModerator(true);\n                setIsAnonymous(false);\n            }\n            setNickName(JSON.parse(sessionStorage.getItem('user')).nickname);\n        }\n\n    }, []);\n    return (\n        <div className=\"bg-white rounded ml-auto mt-3 mb-3 w-[90%]\" key={commentId}>\n            <div>\n                <div className=\"flex cursor-pointer\" onClick={goToProfile}>\n                    {username}, в ответ на комментарий выше\n                </div>\n                <div className=\"flex\">\n                    <div className=\"flex mt-3 mb-3\">\n                        Дата создания - {createdDate}\n                    </div>\n                    <div className=\"flex ml-auto\">\n                        {\n                            (isAdmin || isModerator) && !isAnonymous &&\n                            // isModerator &&\n                            <div className=\"flex mt-3 mb-3 ml-auto mr-2 cursor-pointer\" onClick={deleteComment}>\n                                Удалить\n                            </div>\n                        }\n                        {\n                            nickName === username &&\n                            <div className=\"flex mt-3 mb-3 ml-auto mr-2 cursor-pointer\" onClick={turnOnEditMode}>\n                                Изменить\n                            </div>\n                        }\n                    </div>\n                </div>\n\n            </div>\n            <div className=\"flex mt-3 mb-3\">\n                Дата изменения - {lastUpdatedAt}\n            </div>\n            {!editMode &&\n                <div className=\"flex\">\n                    {comment}\n                    <div className=\"flex ml-1\">\n                        {createdDate !== lastUpdatedAt &&\n                            '(ред.)'\n                        }\n                    </div>\n                </div>\n            }\n            {\n                editMode &&\n                <div>\n                    <textarea className=\"flex rounded bg-gray-200\" defaultValue={comment}\n                              onChange={e => setContent(e.target.value)}/>\n                    <Button text=\"Обновить комментарий\" handleButton={updateComment}/>\n                </div>\n            }\n            {\n                parentId !== null &&\n                <div>\n\n                </div>\n            }\n\n        </div>\n    )\n}\n\nexport default ReplyCommentItem;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}